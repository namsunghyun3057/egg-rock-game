<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>ë°”ìœ„ë¥¼ ì´ê¸°ëŠ” ë°©ë²•</title>
    <style>
        /* [ìŠ¤íƒ€ì¼] ì „ì²´ ë°°ê²½ ë° ë ˆì´ì•„ì›ƒ */
        body {
            background-color: #1a1a1a;
            color: #eee;
            font-family: 'Pretendard', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            
            /* [ìˆ˜ì •ë¨] ë”ë¸” íƒ­ í™•ëŒ€ ë°©ì§€ ë° í„°ì¹˜ ìµœì í™” */
            touch-action: manipulation; 
            -webkit-user-select: none; /* í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ (ê¾¹ ëˆŒë €ì„ ë•Œ íŒŒë€ ë¸”ë¡ ì•ˆ ëœ¨ê²Œ) */
            user-select: none;
        }

        h1 { margin: 0 0 10px 0; font-size: 2rem; }
        .sub-text { color: #888; margin-bottom: 20px; font-size: 0.9rem; }

        /* [ê²Œì„ ìŠ¤í…Œì´ì§€] */
        #game-stage {
            position: relative;
            width: 100%; /* ëª¨ë°”ì¼ ëŒ€ì‘: 800px -> 100% */
            max-width: 800px;
            height: 400px; /* ë†’ì´ ì‚´ì§ ì¡°ì • */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* ë°”ìœ„ ì´ë¯¸ì§€ */
        #rock-image {
            width: 80%; /* ëª¨ë°”ì¼ ëŒ€ì‘: ê³ ì • px ëŒ€ì‹  % ì‚¬ìš© */
            max-width: 400px;
            height: auto;
            object-fit: contain;
            z-index: 10;
            transition: transform 0.1s;
        }

        /* ë‚ ì•„ê°€ëŠ” ê³„ë€ */
        .flying-egg {
            position: absolute;
            width: 80px; /* ëª¨ë°”ì¼ì—ì„œ ë„ˆë¬´ í¬ë©´ ê°€ë¦¬ë‹ˆê¹Œ ì‚´ì§ ì¡°ì • */
            height: auto;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%) rotate(0deg);
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 20;
            pointer-events: none;
        }

        /* [ì• ë‹ˆë©”ì´ì…˜] ë°”ìœ„ í”ë“¤ë¦¼ */
        .shake { animation: shake-ani 0.2s linear; }
        @keyframes shake-ani {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(-5px, 2px) rotate(-1deg); }
            50% { transform: translate(5px, -2px) rotate(1deg); }
            75% { transform: translate(-3px, 1px) rotate(0deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }

        /* [UI] í•˜ë‹¨ ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        #ui-panel {
            margin-top: 10px;
            text-align: center;
            z-index: 30;
            width: 100%;
        }

        #counter { font-size: 1.5rem; font-weight: bold; margin-bottom: 10px; }
        .count-highlight { color: #f4d03f; }

        /* ë²„íŠ¼ ê³„ë€ */
        #throw-btn {
            background: none;
            border: none;
            cursor: pointer;
            transition: transform 0.1s;
            
            /* [ìˆ˜ì •ë¨] ëª¨ë°”ì¼ í„°ì¹˜ ìµœì í™” */
            touch-action: manipulation; 
            -webkit-tap-highlight-color: transparent; /* í„°ì¹˜ ì‹œ ë²ˆì©ê±°ë¦¬ëŠ” íŒŒë€ ë°•ìŠ¤ ì œê±° */
        }
        #throw-btn img {
            width: 100px;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.2));
        }
        #throw-btn:active img { transform: scale(0.9); }
        
        /* ê²Œì„ ì¢…ë£Œ ì‹œ ìŠ¤íƒ€ì¼ */
        .disabled { filter: grayscale(100%); pointer-events: none; opacity: 0.5; }
        .success-msg { color: #4CAF50; font-size: 1.2rem; font-weight: bold; margin-top: 10px; animation: pop-in 0.5s; }
        
        @keyframes pop-in {
            0% { opacity: 0; transform: scale(0.5); }
            100% { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body>

    <h1>ë°”ìœ„ë¥¼ ì´ê¸°ëŠ” ë°©ë²•</h1>
    <p class="sub-text">"ì•„ë§ˆ ì—¬ê¸°ì— ì„ ì£¼ë‹˜ ê³„ì‚° ë“¤ì–´ê°€ë©´ ì–´ë–¨ê¹Œìš”"</p>

    <div id="game-stage">
        <img id="rock-image" src="rock.png" alt="ë°”ìœ„">
    </div>

    <div id="ui-panel">
        <div id="counter">ë˜ì§„ íšŸìˆ˜: <span id="count-num" class="count-highlight">0</span></div>
        
        <button id="throw-btn">
            <img src="egg.png" alt="ê³„ë€ ë˜ì§€ê¸°">
        </button>
        <div id="result-msg"></div>
    </div>

    <script>
        let count = 0;
        let targetCount = 0;
        let isGameClear = false;

        const rockElem = document.getElementById('rock-image');
        const countElem = document.getElementById('count-num');
        const stageElem = document.getElementById('game-stage');
        const throwBtn = document.getElementById('throw-btn');
        const resultMsg = document.getElementById('result-msg');

        function init() {
            targetCount = Math.floor(Math.random() * (52 - 33 + 1)) + 33;
            console.log("ëª©í‘œ íšŸìˆ˜:", targetCount);
        }
        init();

        // [ìˆ˜ì •ë¨] í´ë¦­ê³¼ í„°ì¹˜ ì´ë²¤íŠ¸ë¥¼ ëª¨ë‘ ì²˜ë¦¬í•˜ë„ë¡ ë³€ê²½
        // ëª¨ë°”ì¼ì—ì„œ click ì´ë²¤íŠ¸ëŠ” ì•½ê°„ì˜ ë”œë ˆì´(300ms)ê°€ ìˆì„ ìˆ˜ ìˆì–´ì„œ touchstartë„ ê³ ë ¤
        throwBtn.addEventListener('click', throwEgg); 
        throwBtn.addEventListener('touchstart', function(e) {
            e.preventDefault(); // ê¸°ë³¸ í„°ì¹˜ ë™ì‘ ë°©ì§€ (í™•ëŒ€ ë“±)
            throwEgg();
        }, {passive: false});


        function throwEgg() {
            if (isGameClear) return;

            // ë²„íŠ¼ ëˆŒë¦¼ íš¨ê³¼ (í„°ì¹˜ ì‹œê° ë°˜ì‘)
            const btnImg = throwBtn.querySelector('img');
            btnImg.style.transform = 'scale(0.9)';
            setTimeout(() => { btnImg.style.transform = 'scale(1)'; }, 100);

            const flyingEgg = document.createElement('img');
            flyingEgg.src = 'egg.png';
            flyingEgg.className = 'flying-egg';
            stageElem.appendChild(flyingEgg);

            // ì• ë‹ˆë©”ì´ì…˜
            setTimeout(() => {
                flyingEgg.style.bottom = '200px'; // ëª¨ë°”ì¼ í™”ë©´ ê³ ë ¤ ë†’ì´ ì¡°ì •
                flyingEgg.style.transform = 'translateX(-50%) scale(0.6) rotate(360deg)'; 
                flyingEgg.style.opacity = '1';
            }, 10);

            setTimeout(() => {
                flyingEgg.remove();
                hitRock();
            }, 500); 
        }

        function hitRock() {
            count++;
            countElem.innerText = count;

            rockElem.classList.remove('shake');
            void rockElem.offsetWidth; 
            rockElem.classList.add('shake');

            if (count >= targetCount) {
                gameWin();
            }
        }

        function gameWin() {
            isGameClear = true;
            rockElem.src = 'rock_broken.png';
            rockElem.style.transform = 'scale(1.1)'; 
            throwBtn.classList.add('disabled');
            resultMsg.innerHTML = "ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ë°”ìœ„ë¥¼ ì´ê²¼ìŠµë‹ˆë‹¤.";
            resultMsg.className = "success-msg";
        }
    </script>
</body>
</html>